<html lang="en">
    <!--
        Code for the fill effect animation found here: https://codingflag.blogspot.com/2020/09/liquid-fill-animation-effect-using-html-and-css.html
    -->


    <%
        var fillAmount = 0;
        if(waterConsumed == 0) {
            fillAmount = 250;
        }
        else if((waterConsumed / waterGoal) > 1) {
            fillAmount = -50
        }
        else {
            fillAmount = 250 - ((waterConsumed / waterGoal) * 250);
        }
        
    %>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
        </style>
    <style>
        
        .box {
            width:200px;
            height:200px;
            border:10px solid #ccc;
            border-radius:10px;
            line-height:200px;
            text-align:center;
            color:#ddd;
            font-size:25px;
            font-weight:600;
            text-transform:uppercase;
            position:relative;
            overflow:hidden;
        }
        .box:before {
            content:"";
            position:absolute;
            width:400px;
            height:400px;
            background:#00acee;
            left:50%;
            transform:translateX(-50%);
            border-radius:40%;
            animation:fill 7s;
            animation-fill-mode: forwards;
            z-index:-1;
        }
        @keyframes fill {
            from {
                top:250px;
                transform:translateX(-50%) rotate(0deg);
            }
            to {
                top: <%=fillAmount%>;
                transform:translateX(-50%) rotate(360deg);
            }
        }
        #inner {
            position:relative;
            left: 50%;
            margin-left: -100px;
            
        }
        #centeredButton {
            width: 100px; 
            margin: 0 auto;
            
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
        }
        p.a {
            font-family: 'Roboto', sans-serif;
            font-size: 20px;
        }
    </style>

    <%- include('./partials/header.ejs') %>

    
    <div class="text-center"><h1>Welcome <%= user.name %>!</h1></div>

    <div id="inner" class="box">
        <p><% if(waterGoal != 0) {%><%=Math.round(waterConsumed / waterGoal * 100);%><%} else {%><%=0%><%} %></p>
    </div>
    <div class="text-center">
    <p class="a">You have consumed <%=waterConsumed%> ounces of water towards your goal of <%=waterGoal%> ounces.</p>
    <p><% if(waterConsumed > waterGoal) { %> Congrats you've met your daily water goal! <% } %> </p>
    </div>


    <form action="/addWater" method="POST">
        <div class="text-center" style="margin-bottom: 5px;"> 
        <input type="number"name="water" placeholder="Add water">
        </div>
        <div class="text-center">
        <button type="submit" class="btn btn-primary btn-md">Add</button>
        </div>
        <input type="hidden" value=<%= waterConsumed %> name="waterConsumed" />
    </form>

    <form action="/setGoal" method="POST">
        <div class="text-center" style="margin-bottom: 5px;"> 
        <input type= "number" name="goal" placeholder="Set/change your goal">
        </div>
        <div class="text-center"> 
        <button type="submit" class="btn btn-primary btn-md">Set</button>
        </div>
    </form>
</html>